---
subGroup: "platform"
permalink: "zpqyc5"
layout: default
title: 'Commerce Studio integration with Fusion'
description: 'Needs description'
icon: 'text-size'
subtitle: 'Lucidworks Platform'
doctype: concept
order: 10
---

This type of Fusion integration lets you connect self-hosted Fusion instances to Lucidworks Commerce Studio.

If you want to migrate from Predictive Merchandiser to Commerce Studio, the information in this topic is used in coordination with the procedures described in [Migration guide from Predictive Merchandiser to Commerce Studio](/lw-platform/cs/bpsf27/migration-guide).

You must satisfy the [prerequisites](#prerequisites) and complete all of the procedures in the order described in this topic to implement Lucidworks Commerce Studio:

1. [Create a Commerce Studio integration with Fusion](#create-a-commerce-studio-integration-with-fusion)
2. [Create Fusion user accounts required for Commerce Studio](#create-fusion-user-accounts-required-for-commerce-studio)
3. [Create a Fusion security JWT realm for Commerce Studio](#create-a-fusion-security-jwt-realm-for-commerce-studio)
4. [Create the lwp service account in the JWT realm](#create-the-lwp-service-account-in-the-jwt-realm)
5. [Verify Commerce Studio integration with Fusion](#verify-commerce-studio-integration-with-fusion)
6. [Create a Commerce Studio instance](#create-a-commerce-studio-instance)

<dl><dt><strong>ðŸ’¡ TIP</strong></dt><dd>

This topic is specific to integrating Lucidworks Platform with Fusion for the use of Commerce Studio. 

* To configure a general integration for Lucidworks Platform with Fusion, follow the procedures in [Fusion integrations](/lw-platform/platform/04gi1q/fusion-integrations). 
* To configure an integration that uses the Lucidworks Configuration Promotion tool, follow the procedures in the [Configuration Promotion tool integration with Fusion](/lw-platform/platform/qjns2v/configuration-promotion-integration) topic. 
* To configure a self-hosted Fusion integration with Lucidworks AI, follow the procedures in [Lucidworks AI integrations](/lw-platform/platform/mdlec0/lucidworks-ai-integrations).
</dd></dl>

## Prerequisites

To create an integration, you must have the following prerequisites in place:

* Privileges to access and use Lucidworks Commerce Studio in a Lucidworks platform workspace.

## Create a Commerce Studio integration with Fusion

Complete the following procedures to create an integration from Lucidworks Commerce Studio to Fusion.

## Create Fusion roles required for Commerce Studio

1. Sign in to your Fusion instance as an admin.
2. Click the Fusion application to connect with Commerce Studio.
3. Navigate to **System > Access Control > Roles**.
4. Click **Add Role**.
5. In the **Name** field, enter `lwp_user`.
6. In the **Permissions** field, enter:

   ```
   GET,PUT,DELETE,POST,HEAD:/query/experience-manager/**
   GET,POST:/query/*
   GET:/suggestions/**
   GET:/solr/*/terms
   GET:/apps/*/query-profiles/**
   GET,PUT:/apps/*
   GET:/solr/*/admin/luke
   ```

   This role does not require any UI permissions, so you do not have to select any values in the **UI Permissions** field.
7. In the **Description** field, enter information that describes this role and its use. For example, "The lwp_user account is required to access and use Commerce Studio. It is a super user account, but does not include the ability to get, modify, or delete the `HEAD` section of the site."
8. Click **Save**.
9. Click **Add Role**.
10. In the **Name** field, enter `lwp_service_account`.
11. In the **Permissions** field, enter the following permissions. These permissions include all of the lwp_user account permissions plus the privileges to migrate Fusion Predictive Merchandiser rewrites, rules, templates and zones.

   ```
   GET,PUT,DELETE,POST,HEAD:/query/experience-manager/**
   GET,POST:/query/*
   GET:/suggestions/**
   GET:/solr/*/terms
   GET:/apps/*/query-profiles/**
   GET,PUT:/apps/*
   GET,DELETE,PATCH,PUT,POST,HEAD:/apps/*/query-rewrite/**
   GET,HEAD:/templating/**
   GET:/solr/*/admin/luke
   ```

   This role does not require any UI permissions, so you do not have to select any values in the **UI Permissions** field.
12. In the **Description** field, enter information that describes this role and its use. For example, "The lwp_service_account contains all of the lwp_user permissions as well as the privileges to migrate Fusion Predictive Merchandiser components to Lucidworks Commerce Studio."
13. Click **Save**.

## Create a Fusion security JWT realm for Commerce Studio

1. Sign in to your Fusion instance as an admin.
2. Click the application in which you created the `lwp_user` and `lwp_service_account` accounts to use with Commerce Studio.
3. Navigate to **System > Access Control > Security Realms**.
4. Click **Add Security Realm**.
5. In the **Name** field, enter a user-defined value to identify the connection. For example, **Lucidworks Commerce Studio JWT realm**.
6. In the **Type** field, select **jwt**.
7. Select the **Enabled** checkbox if it is not already selected.
8. Do not select the **Ephemeral Users** checkbox. Ephemeral users are not created in Zookeeper during login. If selected, auto-create users has no effect.
9. Select the **Auto-Create Users** checkbox. If selected, Fusion user accounts are auto-created when users successfully authenticate the first time. If not selected user accounts must be created manually. 
10. In the **Roles** field, select `lwp_user`.
11. In the **JWT Issuer** field, paste the **Issuer URL** value generated in the [Create a Commerce Studio integration with Fusion](#create-a-commerce-studio-integration-with-fusion) procedure.
12. In the **JWK Set URL** field, paste the **JWKS URL** value generated in the [Create a Commerce Studio integration with Fusion](#create-a-commerce-studio-integration-with-fusion) procedure.
13. Do not enter values (default is blank) in any of the following fields:
   * **Signing Key**
   * **Groups Key**
   * **Groups Mapping**
   * **User ID Attribute**
14. Click **Save**.

## Create the lwp service account user in the JWT realm

1. Sign in to your Fusion instance as an admin.
2. Click the application to be connected with Commerce Studio.
3. Navigate to **System > Access Control > Users**.
4. Click **Add User**.
5. In the **Realm** field, select the JWT realm you created in the [Create a Fusion security JWT realm for Commerce Studio](#create-a-fusion-security-jwt-realm-for-commerce-studio).
6. In the **Username** field, enter `lwp-service-account`.
7. In the **Password** field, enter a unique, secure password for the `lwp-service-account`.
8. In the **Confirm Password** field, re-enter the password for the `lwp-service-account`.
9. In the **Roles** field, select the `lwp_service_account` role.
10. In the **Timezone** field, select the appropriate timezone for the user account.
11. Click **Create**.

## Verify Commerce Studio integration with Fusion

When the Fusion security JWT realm is created, complete the following steps to verify the Fusion information is displayed.

## Create a Commerce Studio instance using the UI

**ðŸ”¥ CAUTION**\
Do not create a Commerce Studio instance using the UI if you are migrating data from Predictive Merchandiser into that Commerce Studio instance. Instead, you must create the [instance using the API](/lw-platform/cs/bpsf27/migration-guide#create-a-commerce-studio-instance-using-the-api).

1. Sign in to [Lucidworks Platform](https://platform.lucidworks.com) as a workspace owner.
2. Navigate to **Commerce Studio**. 
3. Click **Create New**.
4. In the **Name** field on the Add Configuration Information screen, enter a unique name for the Commerce Studio instance.
5. In the **Region** field, select the geographic region for the Commerce Studio instance. This cannot be changed after the instance is created.
6. In the **Fusion to Connect** field, select the name of the Fusion integration instance to use in this Commerce Studio instance. This is the value of the **Name** field created in the [Create a Commerce Studio integration with Fusion](#create-a-commerce-studio-integration-with-fusion) procedure.
7. Optional: In the **Signal Store** field, select the option for the location where the Commerce Studio signals are stored. This value is only required if you want to use Lucidworks Analytics. 
8. In the **Fusion Application** field, enter the name of the application you created in Lucidworks Platform that connects to your Fusion instance.
9. Click **Next** to confirm settings, and then **Next** to create the instance.

**ðŸ“Œ NOTE**\
Data from the Fusion app is sent to Commerce Studio so you can create rules and refine the search experience. You can only connect one instance of Commerce Studio to a Fusion app. You cannot create multiple instances of Commerce Studio using the same Fusion app.
